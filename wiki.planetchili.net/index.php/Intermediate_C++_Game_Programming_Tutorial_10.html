<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8" />
<title>Intermediate C++ Game Programming Tutorial 10 - Chilipedia</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":!1,"wgNamespaceNumber":0,"wgPageName":"Intermediate_C++_Game_Programming_Tutorial_10","wgTitle":"Intermediate C++ Game Programming Tutorial 10","wgCurRevisionId":3337,"wgRevisionId":3337,"wgArticleId":73,"wgIsArticle":!0,"wgIsRedirect":!1,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Pages with syntax highlighting errors"],"wgBreakFrames":!1,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Intermediate_C++_Game_Programming_Tutorial_10","wgRelevantArticleId":73,"wgIsProbablyEditable":!1,"wgRestrictionEdit":[],
"wgRestrictionMove":[],"wgWikiEditorEnabledModules":{"toolbar":!1,"dialogs":!1,"preview":!1,"publish":!1}});mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","skins.vector.js"]);
} );</script>
<link rel="stylesheet" href="../load.php%3Fdebug=false&amp;lang=en&amp;modules=ext.pygments|mediawiki.legacy.commonPrint,shared|mediawiki.sectionAnchor|mediawiki.skinning.interface|skins.vector.styles&amp;only=styles&amp;skin=vector.css" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="../load.php%3Fdebug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=vector.css" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}</style>
<script async="" src="../load.php%3Fdebug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector"></script>
<meta name="generator" content="MediaWiki 1.26.3" />
<link rel="shortcut icon" href="../favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="https://wiki.planetchili.net/opensearch_desc.php" title="Chilipedia (en)" />
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.planetchili.net/api.php?action=rsd" />
<link rel="alternate" type="application/atom+xml" title="Chilipedia Atom feed" href="https://wiki.planetchili.net/index.php?title=Special:RecentChanges&amp;feed=atom" />
<!--[if lt IE 7]><style type="text/css">body{behavior:url("/skins/Vector/csshover.min.htc")}</style><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Intermediate_C_Game_Programming_Tutorial_10 skin-vector action-view">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>

						<div class="mw-indicators">
</div>
			<h1 id="firstHeading" class="firstHeading" lang="en">Intermediate C++ Game Programming Tutorial 10</h1>
									<div id="bodyContent" class="mw-body-content">
									<div id="siteSub">From Chilipedia</div>
								<div id="contentSub"></div>
												<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="Intermediate_C++_Game_Programming_Tutorial_10.html#mw-head">navigation</a>, 					<a href="Intermediate_C++_Game_Programming_Tutorial_10.html#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p>The promised day has come. We're finally going to be loading images from bitmap files into memory and drawing them as sprites on the screen. This is where all that stuff we've been learning--data types, pointers, memory management, file access, etc.--is going to pay off bigtime. Also, get fukt massive PutPixel sprite functions; die in a garbage fire.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="Intermediate_C++_Game_Programming_Tutorial_10.html#Topics_Covered"><span class="tocnumber">1</span> <span class="toctext">Topics Covered</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="Intermediate_C++_Game_Programming_Tutorial_10.html#Notes"><span class="tocnumber">2</span> <span class="toctext">Notes</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="Intermediate_C++_Game_Programming_Tutorial_10.html#Channel_Byte_Order"><span class="tocnumber">2.1</span> <span class="toctext">Channel Byte Order</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="Intermediate_C++_Game_Programming_Tutorial_10.html#Self_Assignment"><span class="tocnumber">2.2</span> <span class="toctext">Self Assignment</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="Intermediate_C++_Game_Programming_Tutorial_10.html#Video_Timestamp_Index"><span class="tocnumber">3</span> <span class="toctext">Video Timestamp Index</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="Intermediate_C++_Game_Programming_Tutorial_10.html#Source_Code"><span class="tocnumber">4</span> <span class="toctext">Source Code</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="Intermediate_C++_Game_Programming_Tutorial_10.html#Download_Materials"><span class="tocnumber">5</span> <span class="toctext">Download Materials</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="Intermediate_C++_Game_Programming_Tutorial_10.html#Homework"><span class="tocnumber">6</span> <span class="toctext">Homework</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="Intermediate_C++_Game_Programming_Tutorial_10.html#See_also"><span class="tocnumber">7</span> <span class="toctext">See also</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Topics_Covered">Topics Covered</span></h2>
<ul><li> <code>Surface</code> class for storing image data in memory</li>
<li> Parsing Windows bitmap file headers and loading pixel data</li>
<li> Calculating padding</li>
<li> Drawing sprites (pixel blocks) from a <code>Surface</code> to the screen</li></ul>
<h2><span class="mw-headline" id="Notes">Notes</span></h2>
<h3><span class="mw-headline" id="Channel_Byte_Order">Channel Byte Order</span></h3>
<p>There is a rather large issue with the order in which the color channels are loaded from the bitmap file, but due to a freak of coincidence, the code works regardless. Still, we must address this buttfuckery.
</p><p>The way the channels are laid out in the file is (in order of low offset to high offset) |B| |G| |R|. Now the line of code that simultaneously reads the 3 bytes of the 3 color channels, constructs a Color object, and writes it into the Surface is: <code>PutPixel( x,y,Color( file.get(),file.get(),file.get() ) );</code>. The function prototype of the Color constructor is <code>Color( unsigned char r,unsigned char g,unsigned char b )</code>, so the order here is RGB, and we would expect that our code would be messed up (the R and B channels would be swapped). But this is not the case. What gives?
</p><p>Well you might (understandably) assume that our function call to the ctor evaluates the <code>get()</code> parameter expressions in the following order <code>Color( file.get()<sub>first(B)</sub>,file.get()<sub>second(G)</sub>,file.get()<sub>third(R)</sub> )</code>, that is to say, the list of parameter expressions being evaluated in left-to-right order. In actuality, the compiler evaluates them in right-to-left order, i.e. <code>Color( file.get()<sub>third(R)</sub>,file.get()<sub>second(G)</sub>,file.get()<sub>first(B)</sub> )</code>, and this is why our code happens to work!
</p><p>Even stranger is the fact that <big><b>the C++ standard does not specify the order in which the parameter expressions are evaluated!</b></big> So it is possible that a different compiler could generate code that gives a different permutation of the color channels. In actuality, we can expect most compilers to do it right-to-left because of the way parameters will be pushed onto the stack (which <i>is</i> mandated), but still, it is terrible practice to rely on this unspecified behavior to always be the way we wish it to be.
</p><p>The following code fixes this problem. It will be applied (in later downstream commits) to the Sprite repo and the Twin repo on GitHub.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre>const unsigned char b = file.get();
const unsigned char g = file.get();
const unsigned char r = file.get();
PutPixel( x,y,{ r,g,b } );</pre></div>
<h3><span class="mw-headline" id="Self_Assignment">Self Assignment</span></h3>
<p>We definitely should be checking for self assignment (<code>mySurf = mySurf;</code>) in the assignment operator for <code>Surface</code>. See <a href="Intermediate_C++_Game_Programming_Tutorial_6.html#Errata" title="Intermediate C++ Game Programming Tutorial 6">the Errata of Intermediate 6</a> for more details.
</p>
<h2><span class="mw-headline" id="Video_Timestamp_Index">Video Timestamp Index</span></h2>
<p><a rel="nofollow" class="external text" href="https://youtu.be/0z3uCzitO7Y">Tutorial 10</a>
</p>
<ul><li> Creating a datatype (<code>Surface</code> class) to hold image data <a rel="nofollow" class="external text" href="https://youtu.be/0z3uCzitO7Y?t=0m13s">0:13</a></li>
<li> Add member function <code>DrawSprite</code> to <code>Graphics</code> class to draw a <code>Surface</code> object to the screen <a rel="nofollow" class="external text" href="https://youtu.be/0z3uCzitO7Y?t=5m03s">5:03</a></li>
<li> Test the code with a funky sprite design <a rel="nofollow" class="external text" href="https://youtu.be/0z3uCzitO7Y?t=7m43s">7:43</a></li>
<li> Load sprites in a <code>Surface</code> object from a Bitmap file <a rel="nofollow" class="external text" href="https://youtu.be/0z3uCzitO7Y?t=9m09s">9:09</a></li>
<li> Exploring the Bitmap Filetype <a rel="nofollow" class="external text" href="https://youtu.be/0z3uCzitO7Y?t=9m18s">9:18</a></li>
<li> Load the Bitmap file header <code>BITMAPFILEHEADER</code> <a rel="nofollow" class="external text" href="https://youtu.be/0z3uCzitO7Y?t=10m54s">10:54</a></li>
<li> Load the DIB Header <code>BITMAPINFOHEADER</code> <a rel="nofollow" class="external text" href="https://youtu.be/0z3uCzitO7Y?t=15m08s">15:08</a></li>
<li> Load 8-bit RBG values of the Bitmap File into pixel array of a <code>Surface</code> object <a rel="nofollow" class="external text" href="https://youtu.be/0z3uCzitO7Y?t=17m00s">17:00</a></li>
<li> Calculate padding at the end of a bitmap row <a rel="nofollow" class="external text" href="https://youtu.be/0z3uCzitO7Y?t=18m40s">18:40</a></li>
<li> Do a test run, loading a Bitmap file and drawing it to the screen <a rel="nofollow" class="external text" href="https://youtu.be/0z3uCzitO7Y?t=22m32s">22:32</a></li>
<li> Test the order of the color channels <a rel="nofollow" class="external text" href="https://youtu.be/0z3uCzitO7Y?t=24m46s">24:46</a></li>
<li> Using <code>assert</code>, add a test to see if file loading succeeded <a rel="nofollow" class="external text" href="https://youtu.be/0z3uCzitO7Y?t=25m21s">25:21</a></li>
<li> Homework assignment <a rel="nofollow" class="external text" href="https://youtu.be/0z3uCzitO7Y?t=27m21s">27:21</a></li></ul>
<h2><span class="mw-headline" id="Source_Code">Source Code</span></h2>
<p><a rel="nofollow" class="external text" href="https://github.com/planetchili/sprite">Sprite Repo</a><br />
</p>
<h2><span class="mw-headline" id="Download_Materials">Download Materials</span></h2>
<ul><li> <a rel="nofollow" class="external text" href="https://www.planetchili.net/downloads/I10-Images.zip">Tutorial and Homework Bitmaps</a></li></ul>
<h2><span class="mw-headline" id="Homework">Homework</span></h2>
<p>The homework is to improve the bitmap loading routine to support 32-bit RGB format and to support bitmaps with reverse row order.
</p>
<ul><li><a rel="nofollow" class="external text" href="https://youtu.be/84C5RYLyWLc">Homework solution video</a></li></ul>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul><li> <a href="Intermediate_C++_Game_Programming_Tutorial_11.html" title="Intermediate C++ Game Programming Tutorial 11">Next in series (Tutorial 11)</a></li>
<li> <a href="Intermediate_C++_Game_Programming_Series.html" title="Intermediate C++ Game Programming Series">Intermediate C++ Game Programming Series</a></li></ul>

<!-- 
NewPP limit report
Cached time: 20240731095937
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.006 seconds
Real time usage: 0.012 seconds
Preprocessor visited node count: 45/1000000
Preprocessor generated node count: 62/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 - -total
-->

<!-- Saved in parser cache with key chilipedia:pcache:idhash:73-0!*!0!!en!*!* and timestamp 20240731095937 and revision id 3337
 -->
</div>					<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://wiki.planetchili.net/index.php?title=Intermediate_C%2B%2B_Game_Programming_Tutorial_10&amp;oldid=3337">https://wiki.planetchili.net/index.php?title=Intermediate_C%2B%2B_Game_Programming_Tutorial_10&amp;oldid=3337</a>"					</div>
				<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="https://wiki.planetchili.net/index.php/Special:Categories" title="Special:Categories">Category</a>: <ul><li><a href="https://wiki.planetchili.net/index.php?title=Category:Pages_with_syntax_highlighting_errors&amp;action=edit&amp;redlink=1" class="new" title="Category:Pages with syntax highlighting errors (page does not exist)">Pages with syntax highlighting errors</a></li></ul></div></div>				<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>

			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-login"><a href="https://wiki.planetchili.net/index.php?title=Special:UserLogin&amp;returnto=Intermediate+C%2B%2B+Game+Programming+Tutorial+10" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
															<li  id="ca-nstab-main" class="selected"><span><a href="Intermediate_C++_Game_Programming_Tutorial_10.html"  title="View the content page [c]" accesskey="c">Page</a></span></li>
															<li  id="ca-talk" class="new"><span><a href="https://wiki.planetchili.net/index.php?title=Talk:Intermediate_C%2B%2B_Game_Programming_Tutorial_10&amp;action=edit&amp;redlink=1"  title="Discussion about the content page [t]" accesskey="t" rel="discussion">Discussion</a></span></li>
													</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<h3 id="p-variants-label">
							<span>Variants</span><a href="Intermediate_C++_Game_Programming_Tutorial_10.html#"></a>
						</h3>

						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
															<li id="ca-view" class="selected"><span><a href="Intermediate_C++_Game_Programming_Tutorial_10.html" >Read</a></span></li>
															<li id="ca-viewsource"><span><a href="https://wiki.planetchili.net/index.php?title=Intermediate_C%2B%2B_Game_Programming_Tutorial_10&amp;action=edit"  title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li>
															<li id="ca-history" class="collapsible"><span><a href="https://wiki.planetchili.net/index.php?title=Intermediate_C%2B%2B_Game_Programming_Tutorial_10&amp;action=history"  title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>
													</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<h3 id="p-cactions-label"><span>More</span><a href="Intermediate_C++_Game_Programming_Tutorial_10.html#"></a></h3>

						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>

						<form action="https://wiki.planetchili.net/index.php" id="searchform">
							<div id="simpleSearch">
							<input type="search" name="search" placeholder="Search" title="Search Chilipedia [f]" accesskey="f" id="searchInput" /><input type="hidden" value="Special:Search" name="title" /><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton" /><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchButton" class="searchButton" />							</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="Main_Page.html"  title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id='p-navigation' aria-labelledby='p-navigation-label'>
			<h3 id='p-navigation-label'>Navigation</h3>

			<div class="body">
									<ul>
						<li id="n-recentchanges"><a href="https://wiki.planetchili.net/index.php/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li><li id="n-randompage"><a href="https://wiki.planetchili.net/index.php/Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li><li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>					</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id='p-tb' aria-labelledby='p-tb-label'>
			<h3 id='p-tb-label'>Tools</h3>

			<div class="body">
									<ul>
						<li id="t-whatlinkshere"><a href="https://wiki.planetchili.net/index.php/Special:WhatLinksHere/Intermediate_C%2B%2B_Game_Programming_Tutorial_10" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="https://wiki.planetchili.net/index.php/Special:RecentChangesLinked/Intermediate_C%2B%2B_Game_Programming_Tutorial_10" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="https://wiki.planetchili.net/index.php/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-print"><a href="https://wiki.planetchili.net/index.php?title=Intermediate_C%2B%2B_Game_Programming_Tutorial_10&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li><li id="t-permalink"><a href="https://wiki.planetchili.net/index.php?title=Intermediate_C%2B%2B_Game_Programming_Tutorial_10&amp;oldid=3337" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="https://wiki.planetchili.net/index.php?title=Intermediate_C%2B%2B_Game_Programming_Tutorial_10&amp;action=info" title="More information about this page">Page information</a></li>					</ul>
							</div>
		</div>
				</div>
		</div>
		<div id="footer" role="contentinfo">
							<ul id="footer-info">
											<li id="footer-info-lastmod"> This page was last modified on 5 May 2022, at 13:26.</li>
									</ul>
							<ul id="footer-places">
											<li id="footer-places-privacy"><a href="https://wiki.planetchili.net/index.php/Chilipedia:Privacy_policy" title="Chilipedia:Privacy policy">Privacy policy</a></li>
											<li id="footer-places-about"><a href="https://wiki.planetchili.net/index.php/Chilipedia:About" title="Chilipedia:About">About Chilipedia</a></li>
											<li id="footer-places-disclaimer"><a href="https://wiki.planetchili.net/index.php/Chilipedia:General_disclaimer" title="Chilipedia:General disclaimer">Disclaimers</a></li>
									</ul>
										<ul id="footer-icons" class="noprint">
											<li id="footer-poweredbyico">
							<a href="https://www.mediawiki.org/"><img src="../resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="../resources/assets/poweredby_mediawiki_132x47.png 1.5x, ../resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" /></a>						</li>
									</ul>
						<div style="clear:both"></div>
		</div>
		<script>window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.loader.state({"user":"ready","user.groups":"ready"});mw.loader.load(["mediawiki.toc","mediawiki.action.view.postEdit","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"]);
} );</script><script>window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.config.set({"wgBackendResponseTime":38});
} );</script>
	</body>
</html>
